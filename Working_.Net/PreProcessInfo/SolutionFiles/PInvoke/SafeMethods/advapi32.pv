(%unit (%imports (%import "System.Runtime.InteropServices") (%import "System")) (%package "UpgradeSolution1Support.PInvoke.SafeNative" (%class "advapi32" (%public) (%static) (%method "RegCloseKey" (%int) (%args (%variable (%byval) (%var "hKey") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.advapi32.RegCloseKey") (%param (%id "hKey"))))) (%public) (%shared)) (%method "RegOpenKeyExA" (%int) (%args (%variable (%byval) (%var "hKey") (%int)) (%variable (%byref) (%var "lpszSubKey") (%string)) (%variable (%byref) (%var "dwOptions") (%int)) (%variable (%byval) (%var "samDesired") (%int)) (%variable (%byref) (%var "lpHKey") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.advapi32.RegOpenKeyExA") (%param (%id "hKey") (%ref-param (%id "lpszSubKey")) (%ref-param (%id "dwOptions")) (%id "samDesired") (%ref-param (%id "lpHKey")))))) (%public) (%shared)) (%method "RegQueryValueEx" (%int) (%args (%variable (%byval) (%var "hKey") (%int)) (%variable (%byref) (%var "lpszValueName") (%string)) (%variable (%byval) (%var "lpdwRes") (%int)) (%variable (%byref) (%var "lpdwType") (%int)) (%variable (%byref) (%var "lpDataBuff") (%int)) (%variable (%byref) (%var "nSize") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.advapi32.RegQueryValueEx") (%param (%id "hKey") (%ref-param (%id "lpszValueName")) (%id "lpdwRes") (%ref-param (%id "lpdwType")) (%ref-param (%id "lpDataBuff")) (%ref-param (%id "nSize")))))) (%public) (%shared)) (%method "RegQueryValueExA" (%int) (%args (%variable (%byval) (%var "hKey") (%int)) (%variable (%byref) (%var "lpszValueName") (%string)) (%variable (%byval) (%var "lpdwRes") (%int)) (%variable (%byref) (%var "lpdwType") (%int)) (%variable (%byref) (%var "lpDataBuff") (%string)) (%variable (%byref) (%var "nSize") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.advapi32.RegQueryValueExA") (%param (%id "hKey") (%ref-param (%id "lpszValueName")) (%id "lpdwRes") (%ref-param (%id "lpdwType")) (%ref-param (%id "lpDataBuff")) (%ref-param (%id "nSize")))))) (%public) (%shared)))))