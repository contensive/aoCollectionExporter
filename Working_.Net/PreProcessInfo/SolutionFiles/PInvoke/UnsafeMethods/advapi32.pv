(%unit (%imports (%import "System.Runtime.InteropServices") (%import "System")) (%package "UpgradeSolution1Support.PInvoke.UnsafeNative" (%class (%attribute-list (%attribute (%id "System.Security.SuppressUnmanagedCodeSecurity"))) "advapi32" (%public) (%static) (%method (%attribute-list (%attribute (%call (%id "DllImport") (%param "advapi32.dll" (%= (%id "CharSet") (%dot (%id "CharSet") (%id "Ansi"))) (%= (%id "SetLastError") (%true)) (%= (%id "ExactSpelling") (%true)))))) "RegCloseKey" (%int) (%args (%variable (%byval) (%var "hKey") (%int))) (%extern) (%public) (%static)) (%method (%attribute-list (%attribute (%call (%id "DllImport") (%param "advapi32.dll" (%= (%id "CharSet") (%dot (%id "CharSet") (%id "Ansi"))) (%= (%id "SetLastError") (%true)) (%= (%id "ExactSpelling") (%true)))))) "RegOpenKeyExA" (%int) (%args (%variable (%byval) (%var "hKey") (%int)) (%variable (%attribute-list (%attribute (%id "MarshalAs") (%id "UnmanagedType.VBByRefStr"))) (%byref) (%var "lpszSubKey") (%string)) (%variable (%byref) (%var "dwOptions") (%int)) (%variable (%byval) (%var "samDesired") (%int)) (%variable (%byref) (%var "lpHKey") (%int))) (%extern) (%public) (%static)) (%method (%attribute-list (%attribute (%call (%id "DllImport") (%param "advapi32.dll" (%= (%id "EntryPoint") "RegQueryValueExA") (%= (%id "CharSet") (%dot (%id "CharSet") (%id "Ansi"))) (%= (%id "SetLastError") (%true)) (%= (%id "ExactSpelling") (%true)))))) "RegQueryValueEx" (%int) (%args (%variable (%byval) (%var "hKey") (%int)) (%variable (%attribute-list (%attribute (%id "MarshalAs") (%id "UnmanagedType.VBByRefStr"))) (%byref) (%var "lpszValueName") (%string)) (%variable (%byval) (%var "lpdwRes") (%int)) (%variable (%byref) (%var "lpdwType") (%int)) (%variable (%byref) (%var "lpDataBuff") (%int)) (%variable (%byref) (%var "nSize") (%int))) (%extern) (%public) (%static)) (%method (%attribute-list (%attribute (%call (%id "DllImport") (%param "advapi32.dll" (%= (%id "CharSet") (%dot (%id "CharSet") (%id "Ansi"))) (%= (%id "SetLastError") (%true)) (%= (%id "ExactSpelling") (%true)))))) "RegQueryValueExA" (%int) (%args (%variable (%byval) (%var "hKey") (%int)) (%variable (%attribute-list (%attribute (%id "MarshalAs") (%id "UnmanagedType.VBByRefStr"))) (%byref) (%var "lpszValueName") (%string)) (%variable (%byval) (%var "lpdwRes") (%int)) (%variable (%byref) (%var "lpdwType") (%int)) (%variable (%attribute-list (%attribute (%id "MarshalAs") (%id "UnmanagedType.VBByRefStr"))) (%byref) (%var "lpDataBuff") (%string)) (%variable (%byref) (%var "nSize") (%int))) (%extern) (%public) (%static)))))